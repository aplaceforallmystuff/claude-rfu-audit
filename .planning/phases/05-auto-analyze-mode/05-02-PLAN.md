---
phase: 05-auto-analyze-mode
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - skill/SKILL.md
autonomous: true

must_haves:
  truths:
    - "User can invoke /rfu-audit --auto-analyze [path]"
    - "Auto-analyze runs before gate scoring"
    - "Extracted data requires human verification"
    - "Auto-analyze failures degrade to standard audit flow"
  artifacts:
    - path: "skill/SKILL.md"
      provides: "Auto-analyze mode integration"
      contains: "--auto-analyze"
  key_links:
    - from: "skill/SKILL.md"
      to: "skill/guides/AUTO-ANALYZE.md"
      via: "guide reference"
      pattern: "guides/AUTO-ANALYZE.md"
---

<objective>
Add --auto-analyze flag support to SKILL.md with mode detection, extraction step in process, and verification workflow integration.

Purpose: Users need a way to invoke auto-analyze mode that pre-populates gate context from project files before scoring begins.

Output: Updated `skill/SKILL.md` with auto-analyze mode fully integrated
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-auto-analyze-mode/05-RESEARCH.md

# Current skill file to modify
@skill/SKILL.md

# Reference for existing mode pattern (--quick)
@skill/config/gates-quick.md

# Guide that will be created by 05-01 (reference even if not yet complete)
# @skill/guides/AUTO-ANALYZE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add --auto-analyze flag to Usage and Mode Selection</name>
  <files>skill/SKILL.md</files>
  <action>
Update SKILL.md Usage section to include --auto-analyze flag:

**1. Update Usage code block:**
```
/rfu-audit [project-path] [--quick] [--auto-analyze]
/rfu-audit ~/Dev/my-project
/rfu-audit ~/Dev/my-project --quick
/rfu-audit ~/Dev/my-project --auto-analyze
/rfu-audit ~/Dev/my-project --auto-analyze --quick
```

Note: --auto-analyze and --quick can be combined.

**2. Update Mode Selection table:**
Add auto-analyze as a modifier row:

| Flag | Mode | Gates | Config | Template | Pre-step |
|------|------|-------|--------|----------|----------|
| (none) | Full | 11 gates | `config/gates-full.md` | `templates/audit-report.md` | - |
| `--quick` | Quick | 5 gates | `config/gates-quick.md` | `templates/audit-report-quick.md` | - |
| `--auto-analyze` | Full + Extract | 11 gates | `config/gates-full.md` | `templates/audit-report.md` | Extract & verify |
| `--auto-analyze --quick` | Quick + Extract | 5 gates | `config/gates-quick.md` | `templates/audit-report-quick.md` | Extract & verify |

**3. Add Auto-Analyze Mode description (after Quick mode description):**

**Auto-analyze mode** extracts project information from README.md and package.json before scoring begins. Extracted data is presented as suggestions for human verification. Use it to reduce manual data entry when auditing unfamiliar projects.

**Important:** Auto-analyze extracts suggestions, not scores. Human verification is required before gate scoring begins.
  </action>
  <verify>
SKILL.md Usage section shows:
- --auto-analyze in invocation examples
- Mode Selection table includes auto-analyze rows
- Description explains extraction + verification workflow
  </verify>
  <done>
Usage section updated with --auto-analyze flag, examples, and mode table
  </done>
</task>

<task type="auto">
  <name>Task 2: Add extraction step to Process section</name>
  <files>skill/SKILL.md</files>
  <action>
Update SKILL.md Process section to include auto-analyze step:

**1. Add step 1.5 after "Read project files" (renumber subsequent steps):**

Current process:
0. Validate input
1. Read project files
2. Select mode (--quick flag)
...

New process with auto-analyze:
0. **Validate input**: Run 6-stage validation (see Input Validation section)
1. **Read project files**: README, package.json, main source files
2. **Extract context (if --auto-analyze)**:
   - Read README.md and package.json
   - Use structured extraction to identify: project name, description, value proposition, target users, key features, installation time estimate, prerequisites
   - Present extracted suggestions with confidence levels
   - Await human verification (approve/edit/reject each field)
   - For complete extraction workflow, see `guides/AUTO-ANALYZE.md`
3. **Select mode**: Based on `--quick` flag:
   - Quick mode: Use `config/gates-quick.md` (5 gates)
   - Full mode: Use `config/gates-full.md` (11 gates)
4. **Walk through each gate sequentially** (per selected config)
5. **Score each gate**: Pass (1) or Fail (0) â€” use extracted context if available
6. **Provide evidence** for each score
7. **Generate prioritized fix recommendations** (full mode) or triage recommendation (quick mode)
8. **Output structured report** using corresponding template

**2. Add note about extracted context usage:**

After step 2, add:

> **Using Extracted Context**
>
> When --auto-analyze is used, verified extracted data is available during gate scoring:
> - Gate 1 (5 Whys): Use `value_proposition` as starting point for why chain
> - Gate 3 (10-Minute): Use `installation_time_estimate` and `prerequisites`
> - Gate 4 (Bartender): Use `one_line_description` as candidate sentence
> - Gate 5 (Wallet): Use `target_users` when identifying who would pay
> - Gate 10 (Pareto): Use `key_features` as feature list to analyze
>
> Extracted data accelerates scoring but does not replace gate evaluation. Each gate still requires judgment.
  </action>
  <verify>
SKILL.md Process section shows:
- Step 2 for extraction (if --auto-analyze)
- Reference to guides/AUTO-ANALYZE.md
- "Using Extracted Context" callout mapping fields to gates
- Steps properly renumbered (0 through 8)
  </verify>
  <done>
Process section includes auto-analyze extraction step with field-to-gate mapping
  </done>
</task>

<task type="auto">
  <name>Task 3: Add AUTO-ANALYZE.md reference and error handling</name>
  <files>skill/SKILL.md</files>
  <action>
**1. Add reference to AUTO-ANALYZE.md in related sections:**

After the Input Validation section, add:

---

## Auto-Analyze (Optional)

When invoked with `--auto-analyze`, the skill extracts project context from files before scoring begins.

**What gets extracted:**
- Project name, one-line description
- Value proposition, target users
- Key features, installation time estimate, prerequisites

**How it works:**
1. Read README.md and package.json
2. Extract fields using structured prompts
3. Present suggestions with confidence levels (HIGH/MEDIUM/LOW/UNCERTAIN)
4. Human verifies each suggestion (approve/edit/reject)
5. Verified data available during gate scoring

**Graceful degradation:**
- If extraction fails for a field, prompt manual entry
- Partial extraction still proceeds (only project_name required)
- Auto-analyze failure does not block the audit

For complete extraction heuristics, confidence rules, and verification workflow, see `guides/AUTO-ANALYZE.md`.

**2. Update "For borderline cases" reference to include auto-analyze:**

Current:
```
For borderline cases, consult `guides/EDGE-CASES.md` (when available).
```

New:
```
For borderline cases, consult `guides/EDGE-CASES.md`.
For auto-analyze extraction details, see `guides/AUTO-ANALYZE.md`.
For input validation patterns, see `guides/INPUT-VALIDATION.md`.
```
  </action>
  <verify>
SKILL.md includes:
- New "Auto-Analyze (Optional)" section with workflow summary
- Reference to guides/AUTO-ANALYZE.md
- Graceful degradation documented
- Updated guide references section
  </verify>
  <done>
SKILL.md has complete auto-analyze integration with guide references and error handling
  </done>
</task>

</tasks>

<verification>
1. Usage section shows --auto-analyze in examples and mode table
2. Mode Selection table includes auto-analyze modifier rows (4 rows total)
3. Process section includes extraction step (step 2)
4. "Using Extracted Context" callout maps fields to gates
5. New "Auto-Analyze (Optional)" section exists
6. Reference to guides/AUTO-ANALYZE.md included
7. Graceful degradation documented (extraction failure does not block audit)
</verification>

<success_criteria>
- `/rfu-audit --auto-analyze [path]` invocation documented
- Auto-analyze combinable with --quick (4 mode combinations)
- Extraction step integrated into Process flow
- Field-to-gate mapping documented
- Human verification emphasized (not optional)
- Guide reference to AUTO-ANALYZE.md included
</success_criteria>

<output>
After completion, create `.planning/phases/05-auto-analyze-mode/05-02-SUMMARY.md`
</output>
