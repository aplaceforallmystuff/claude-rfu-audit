---
phase: 06-actionable-output
plan: 02
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - skill/templates/audit-report.md
  - skill/templates/audit-report-quick.md
  - skill/SKILL.md
autonomous: true

must_haves:
  truths:
    - "Full audit report includes priority matrix section with ranked fixes"
    - "Quick audit report includes same priority matrix format"
    - "Each failed gate shows effort estimate and resources inline"
    - "SKILL.md process includes priority matrix generation step"
  artifacts:
    - path: "skill/templates/audit-report.md"
      provides: "Full audit template with Priority Matrix section"
      contains: "## Priority Matrix"
    - path: "skill/templates/audit-report-quick.md"
      provides: "Quick audit template with Priority Matrix section"
      contains: "## Priority Matrix"
    - path: "skill/SKILL.md"
      provides: "Process includes priority matrix step"
      contains: "guides/PRIORITY-MATRIX.md"
  key_links:
    - from: "skill/templates/audit-report.md"
      to: "skill/guides/PRIORITY-MATRIX.md"
      via: "template follows guide format"
      pattern: "Top Priority Fixes"
    - from: "skill/SKILL.md"
      to: "skill/guides/PRIORITY-MATRIX.md"
      via: "process reference"
      pattern: "PRIORITY-MATRIX"
---

<objective>
Update audit report templates to include the new Priority Matrix section and update SKILL.md to reference priority matrix generation in the process.

Purpose: Replaces the existing "Priority Fixes" section with structured, actionable priority matrices that show effort estimates and resource links inline.

Output: Updated templates with Priority Matrix section, updated SKILL.md process.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-actionable-output/06-CONTEXT.md
@.planning/phases/06-actionable-output/06-RESEARCH.md
@.planning/phases/06-actionable-output/06-01-SUMMARY.md
@skill/templates/audit-report.md
@skill/templates/audit-report-quick.md
@skill/SKILL.md
@skill/guides/PRIORITY-MATRIX.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update full audit template with Priority Matrix</name>
  <files>skill/templates/audit-report.md</files>
  <action>
Update `skill/templates/audit-report.md`:

1. **Remove the old "Priority Fixes" section** (lines 205-218 approximately):
   - Delete: `## Priority Fixes`
   - Delete: `To reach RFU Certified status:`
   - Delete: `### Critical (Must Fix)` / `{{critical_fixes}}`
   - Delete: `### Important (Should Fix)` / `{{important_fixes}}`
   - Delete: `### Nice to Have` / `{{nice_fixes}}`

2. **Add new "Priority Matrix" section** after the Scorecard section (before Next Steps):

```markdown
---

## Priority Matrix

{{#if has_failures}}
### Top Priority Fixes

{{#each top_priority_fixes}}
{{index}}. **Gate {{gate_number}}: {{gate_name}}** — Effort: {{effort_level}}

   **Issue:** {{issue_summary}}

   **Why fix this first:** {{impact_rationale}}

   **Fix:** {{fix_action}}

   **Resources:** {{resources}}

   {{#if unlocks}}
   Unlocks: Fixing this helps with {{unlocks}}
   {{/if}}
   {{#if blocked_by}}
   Blocked by: Must fix {{blocked_by}} first
   {{/if}}

{{/each}}

{{#if other_failed_gates}}
### Other Failed Gates

{{#each other_failed_gates}}
- **Gate {{gate_number}}: {{gate_name}}** — Effort: {{effort_level}} — {{issue_summary}}
{{/each}}
{{/if}}

{{#if borderline_gates}}
### Recommended (Borderline)

{{#each borderline_gates}}
- **Gate {{gate_number}}: {{gate_name}}** — {{borderline_reason}}
{{/each}}
{{/if}}

{{else}}
All gates passed! Project is RFU Certified.

{{#if borderline_gates}}
### Recommended Optimizations

While all gates passed, these areas could be strengthened:

{{#each borderline_gates}}
- **Gate {{gate_number}}: {{gate_name}}** — {{borderline_reason}}
{{/each}}
{{/if}}
{{/if}}
```

Note: The template uses pseudo-Handlebars syntax for illustration. In practice, Claude generates this section dynamically following the PRIORITY-MATRIX.md guide. The key structure is:
- Top Priority Fixes (detailed, up to 3)
- Other Failed Gates (compact list)
- Recommended/Borderline (if applicable)
- All-pass case handled separately

3. **Add new template variables section** at the end of the file (or update if exists):

Add documentation comment noting the Priority Matrix section is dynamically generated following `guides/PRIORITY-MATRIX.md`, not filled from static variables.
  </action>
  <verify>
- File no longer contains "## Priority Fixes" section
- File contains "## Priority Matrix" section
- Priority Matrix appears after Scorecard, before Next Steps
- Template shows tiered structure (Top Priority, Other Failed, Borderline)
  </verify>
  <done>
Full audit template includes Priority Matrix section with tiered display format, replacing the old Priority Fixes section.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update quick audit template with Priority Matrix</name>
  <files>skill/templates/audit-report-quick.md</files>
  <action>
Update `skill/templates/audit-report-quick.md`:

1. **Add Priority Matrix section** after Quick Scorecard, before Next Steps:

```markdown
---

## Priority Matrix

{{#if has_failures}}
### Top Priority Fixes

{{#each top_priority_fixes}}
{{index}}. **Gate {{gate_number}}: {{gate_name}}** — Effort: {{effort_level}}

   **Issue:** {{issue_summary}}

   **Why fix this first:** {{impact_rationale}}

   **Fix:** {{fix_action}}

   **Resources:** {{resources}}

{{/each}}

{{#if other_failed_gates}}
### Other Failed Gates

{{#each other_failed_gates}}
- **Gate {{gate_number}}: {{gate_name}}** — Effort: {{effort_level}} — {{issue_summary}}
{{/each}}
{{/if}}

{{else}}
All quick-check gates passed!

Proceed to full audit (`/rfu-audit {{project_path}}`) for complete evaluation.
{{/if}}

---
```

2. **Keep the existing Next Steps section** - it already has triage-specific guidance

3. **Maintain quick mode footer** indicating this is a 5-gate triage

Note: Quick mode typically has 0-2 failures (5 gates total), so "Top Priority Fixes" will usually show all failures in detail. The "Other Failed Gates" section may rarely be used.
  </action>
  <verify>
- File contains "## Priority Matrix" section
- Priority Matrix appears after Quick Scorecard, before Next Steps
- Template shows same structure as full audit (Top Priority, Other Failed)
- All-pass case suggests proceeding to full audit
  </verify>
  <done>
Quick audit template includes Priority Matrix section, same format as full audit but applied to 5-gate subset.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update SKILL.md process to include priority matrix generation</name>
  <files>skill/SKILL.md</files>
  <action>
Update `skill/SKILL.md` in the Process section:

1. **Add priority matrix generation step** between step 6 (Provide evidence) and step 7 (currently "Generate prioritized fix recommendations"):

Update the Process section (around line 214-234) to:

```markdown
## Process

When auditing a project:

0. **Validate input**: Run 6-stage validation (see Input Validation section)
1. **Read project files**: README, package.json, main source files
2. **Extract context (if --auto-analyze)**:
   - Read README.md and package.json
   - Use structured extraction to identify: project name, description, value proposition, target users, key features, installation time estimate, prerequisites
   - Present extracted suggestions with confidence levels
   - Await human verification (approve/edit/reject each field)
   - For complete extraction workflow, see `guides/AUTO-ANALYZE.md`
3. **Select mode**: Based on `--quick` flag:
   - Quick mode: Use `config/gates-quick.md` (5 gates)
   - Full mode: Use `config/gates-full.md` (11 gates)
4. **Walk through each gate sequentially** (per selected config)
5. **Score each gate**: Pass (1) or Fail (0) — use extracted context if available
6. **Provide evidence** for each score
7. **Generate priority matrix**:
   - Rank failed gates using impact-effort matrix (see `guides/PRIORITY-MATRIX.md`)
   - Assign effort estimates (quick/medium/involved) per gate
   - Link resources inline with each fix
   - Note gate dependencies (unlocks/blocked by)
   - For all-pass audits, check for borderline gates as optimization opportunities
8. **Output structured report** using corresponding template:
   - Quick mode: `templates/audit-report-quick.md`
   - Full mode: `templates/audit-report.md`
```

2. **Add reference to PRIORITY-MATRIX.md** in the guides list at the bottom (around line 246-248):

Update the reference list to include:
```markdown
For borderline cases, consult `guides/EDGE-CASES.md`.
For auto-analyze extraction details, see `guides/AUTO-ANALYZE.md`.
For input validation patterns, see `guides/INPUT-VALIDATION.md`.
For priority matrix generation, see `guides/PRIORITY-MATRIX.md`.
```
  </action>
  <verify>
- Process section includes step 7 "Generate priority matrix"
- Step 7 references `guides/PRIORITY-MATRIX.md`
- Reference list at bottom includes PRIORITY-MATRIX.md
- Step numbers are updated correctly (8 steps total: 0-8)
  </verify>
  <done>
SKILL.md process explicitly includes priority matrix generation step with reference to the guide.
  </done>
</task>

</tasks>

<verification>
- [ ] audit-report.md no longer has "Priority Fixes" section
- [ ] audit-report.md has "Priority Matrix" section with tiered format
- [ ] audit-report-quick.md has "Priority Matrix" section
- [ ] SKILL.md process includes priority matrix step (step 7)
- [ ] SKILL.md references guides/PRIORITY-MATRIX.md
- [ ] All three files successfully updated
</verification>

<success_criteria>
1. Both templates show Priority Matrix with Top Priority Fixes (detailed), Other Failed Gates (compact), and Borderline/Recommended sections
2. Old "Priority Fixes" section is completely removed from full template
3. SKILL.md process clearly directs auditor to generate priority matrix before outputting report
4. All guide references are present and accurate
</success_criteria>

<output>
After completion, create `.planning/phases/06-actionable-output/06-02-SUMMARY.md`
</output>
